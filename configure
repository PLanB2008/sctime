#!/bin/ksh

arch=$1

if [[ -z $arch ]] ; then
   echo "Syntax: ./configure <architecture>"
   echo "architecture may be one of the follwing values:"
   \ls -1 ./mkspecs/$arch
   exit 1 ;
fi
shift
if [[ ! -d ./mkspecs/$arch ]] ; then
   echo "Unknown architecture \"$arch\""
   exit 2 ;
fi
echo "Running qmake"
qmake -makefile -spec `pwd`/mkspecs/$arch $* sctime.pro || echo "qmake failed!"
sed -e "s,-spec mkspecs/,-spec `pwd`/mkspecs/,g" Makefile > Makefile.new
mv Makefile.new Makefile